<!doctype html>
<html>

<head>
  <title>Project1</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
  <link rel="stylesheet" href="./static/tailwind-all.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
  <style>
    #map {
      width: 100%;
      height: 500px;
    }
  </style>
  <!--
    #formulaire {
      width: 300px;
      height: 400px;
      background-color: red;
    }

    #form {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  </style> -->
</head>

<body>

  
  <!--
  This example requires updating your template:

  
  <html class="h-full bg-gray-100">
  <body class="h-full">
  
-->
  <div class="">
    <nav class="bg-gray-800">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="flex h-16 items-center justify-between">
          <div class="flex items-center">
            <div class="flex-shrink-0">
              <a href="#" class="text-white px-3 py-2 rounded-md text-sm font-bold" aria-current="page">Project 2 :</a>

            </div>
            <div class="hidden md:block">
              <div class="ml-10 flex items-baseline space-x-4">
                <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
                <a href="#" class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium"
                  aria-current="page">Home</a>
                <a href="/csvPredict" class="bg-gray-900 text-white px-3 py-2 rounded-md text-sm font-medium"
                  aria-current="page">Predict File</a>
              </div>
            </div>
          </div>
          <div class="-mr-2 flex md:hidden">
            <!-- Mobile menu button -->
            <button type="button"
              class="inline-flex items-center justify-center rounded-md bg-gray-800 p-2 text-gray-400 hover:bg-gray-700 hover:text-white focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-gray-800"
              aria-controls="mobile-menu" aria-expanded="false">
              <span class="sr-only">Open main menu</span>
              <!--
              Heroicon name: outline/bars-3

              Menu open: "hidden", Menu closed: "block"
            -->
              <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
              </svg>
              <!--
              Heroicon name: outline/x-mark

              Menu open: "block", Menu closed: "hidden"
            -->
              <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile menu, show/hide based on menu state. -->
      <div class="md:hidden" id="mobile-menu">
        <div class="space-y-1 px-2 pt-2 pb-3 sm:px-3">
          <!-- Current: "bg-gray-900 text-white", Default: "text-gray-300 hover:bg-gray-700 hover:text-white" -->
          <a href="#" class="bg-gray-900 text-white block px-3 py-2 rounded-md text-base font-medium"
            aria-current="page">PH Prediction </a>
        </div>

      </div>
    </nav>

    <header class="bg-white shadow">
      <div class="mx-auto max-w-7xl py-6 px-4 sm:px-6 lg:px-8">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900">PH Prediction </h1>
      </div>
    </header>
    <main>
      <div class="mx-auto max-w-7xl py-6 sm:px-6 lg:px-8 grid grid-cols-4 gap-4">
        <!-- Replace with your content -->
        <div class=""></div>
        <div class="px-4 py-6 sm:px-0 col-span-2">
          <div class="h-96 rounded-lg border-4 border-dashed border-gray-200 flex flex-col w-full">
            <div id="map" class="flex flex-col w-4" ></div>
            <div class="w-full">
              <form id="form">
                <div id="formulaire" class="p-5 flex -mx-3 flex-wrap">
                  <div id="input" class="flex flex-col sm:w-4 px-3 lg:w-1/2 my-5">
                    <label for="LATITUDE" class="text-gray-500 mb-2">LATITUDE</label>
                    <input type="text" id="LATITUDE" name="LATITUDE" placeholder="LATITUDE" placeholder="LATITUDE"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div>
                  <div id="input" class="flex flex-col sm:w-full px-3 lg:w-1/2 my-5">
                    <label for="LONGITUDE" class="text-gray-500 mb-2">LONGITUDE</label>
                    <input type="text" id="LONGITUDE" name="LONGITUDE" placeholder="LONGITUDE"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div>
                  <!-- <div id="input" class="flex flex-col sm:w-full px-3 lg:w-1/2 my-5">
                    <label for="username" class="text-gray-500 mb-2">Date</label>
                    <input type="date" id="DATE" name="DATE" placeholder="DATE" placeholder="Date"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div> -->
                  <div id="input" class="flex flex-col sm:w-full px-3 lg:w-1/2 my-5">
                    <label for="Profondeur" class="text-gray-500 mb-2">Profondeur</label>
                    <input type="number" id="DEPTH" name="DEPTH" placeholder="Profondeur"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div>
                  <div id="input" class="flex flex-col sm:w-full px-3 lg:w-1/2 my-5">
                    <label for="ALKALI" class="text-gray-500 mb-2">ALKALI</label>
                    <input type="number" id="ALKALI" name="ALKALI" placeholder="ALKALI" placeholder="ALKALI"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div>
                  <div id="input" class="flex flex-col sm:w-full px-3 lg:w-1/2 my-5">
                    <label for="TCARBN" class="text-gray-500 mb-2">TCARBN</label>
                    <input type="number" id="TCARBN" name="TCARBN" placeholder="TCARBN"
                      class="appearance-none border-2 border-gray-500 rounded-lg px-4 py-3 placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-green-600 focus:shadow-lg" />
                  </div>
                  
                 
                    
                </div>
              </form>
            </div>
            <button id="btn"
            class="w-1/3 block mx-auto mt-6 bg-blue-500 py-4 rounded text-center font-bold text-white"
            type="submit" >Submit</button>
            <div >
              <h2 class="w-1/3 block mx-auto my-12 bg-green-500 py-4 rounded text-center font-bold text-white" id="result">Resultat
                : {{ res }}</h2>
            </div>
          </div>
        </div>
        <!-- /End replace -->
      </div>
    </main>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var map = L.map('map').setView([34.020882, -6.841650], 3);
    
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(map);

      var marker = L.marker([51.5, -0.09]).addTo(map);
      //  / action="http://127.0.0.1:5001/predict"  
      map.on('click', function (e) {
        marker.setLatLng(e.latlng);
        document.getElementById('LATITUDE').value = e.latlng.lat;
        document.getElementById('LONGITUDE').value = e.latlng.lng;
      });
    });
    document.getElementById('btn').addEventListener("click",sent);
    function sent(e){
        e.preventDefault();
        console.log("test");
        var LONGITUDE =  document.getElementById("LONGITUDE").value;
        var LATITUDE  =  document.getElementById("LATITUDE").value;
        var ALKALI    =  document.getElementById("ALKALI").value;
        var TCARBN    =  document.getElementById("TCARBN").value;
        var DEPTH     =  document.getElementById("DEPTH").value;
        // var dd        =  document.getElementById("DATE").value;
        // var date = new Date(dd);
        // var day = ("0" + date.getDate()).slice(-2);
        // var month = ("0" + (date.getMonth() + 1)).slice(-2);
        // var year = date.getFullYear();
        // var DATE = year + month +day ;
        // console.log(DATE)
        
        $.ajax({
                type: "POST",
                url: "http://localhost:5002/predict",
                  data: {
                      //  DATE: DATE,
                        DEPTH: DEPTH,
                        LONGITUDE: LONGITUDE,
                        LATITUDE:LATITUDE,
                        TCARBN:TCARBN,
                        ALKALI:ALKALI},
                success: function (data) {
                    $("#result").html("Resultat: " + data.result);
                }
            });
        console.log("Done!!!!!");

    }
  
  </script>
</body>

</html>